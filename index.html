<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document Handler</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <style>
        body {
            padding: 20px;
        }
    </style>
</head>
<body>
    <h1>Document Handler</h1>
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <h2>Upload Document</h2>
                <form id="upload-form">
                    <div class="form-group">
                        <input type="file" id="file" name="file">
                    </div>
                    <button type="submit" class="btn btn-primary">Upload</button>
                </form>
            </div>
            <div class="col-md-6">
                <h2>Documents</h2>
                <ul id="documents-list"></ul>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <h2>Create Document</h2>
                <form id="create-form">
                    <div class="form-group">
                        <label for="filename">Filename:</label>
                        <input type="text" id="filename" name="filename">
                    </div>
                    <div class="form-group">
                        <label for="content">Content:</label>
                        <textarea id="content" name="content"></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Create</button>
                </form>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <h2>Update Document</h2>
                <form id="update-form">
                    <div class="form-group">
                        <label for="filename">Filename:</label>
                        <input type="text" id="filename" name="filename">
                    </div>
                    <div class="form-group">
                        <label for="content">Content:</label>
                        <textarea id="content" name="content"></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Update</button>
                </form>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <h2>Delete Document</h2>
                <form id="delete-form">
                    <div class="form-group">
                        <label for="filename">Filename:</label>
                        <input type="text" id="filename" name="filename">
                    </div>
                    <button type="submit" class="btn btn-primary">Delete</button>
                </form>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <h2>Generate Document</h2>
                <form id="generate-form">
                    <div class="form-group">
                        <label for="prompt">Prompt:</label>
                        <input type="text" id="prompt" name="prompt">
                    </div>
                    <button type="submit" class="btn btn-primary">Generate</button>
                </form>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script>
        const api_url = "https://0c12-34-16-161-48.ngrok-free.app";

        // Upload document
        $("#upload-form").submit(function(e) {
            e.preventDefault();
            const file = $("#file")[0].files[0];
            const formData = new FormData();
            formData.append("file", file);

            $.ajax({
                url: api_url + "/upload",
                type: "POST",
                data: formData,
                contentType: false,
                processData: false,
                success: function(response) {
                    console.log(response);
                    listDocuments();
                }
            });
        });

        // List documents
        function listDocuments() {
            $.ajax({
                url: api_url + "/documents",
                type: "GET",
                success: function(response) {
                    const documents = response;
                    const documentsList = $("#documents-list");
                    documentsList.empty();

                    documents.forEach(function(document) {
                        const li = $("<li>").text(document);
                        documentsList.append(li);
                    });
                }
            });
        }
        listDocuments();

        // Create document
        $("#create-form").submit(function(e) {
            e.preventDefault();
            const filename = $("#filename").val();
            const content = $("#content").val();

            $.ajax({
                url: api_url + "/create-document",
                type: "POST",
                data: JSON.stringify({ filename, content }),
                contentType: "application/json",
                success: function(response) {
                    console.log(response);
                    listDocuments();
                }
            });
        });

        // Update document
        $("#update-form").submit(function(e) {
            e.preventDefault();
            const filename = $("#filename").val();
            const content = $("#content").val();

            $.ajax({
                url: api_url + "/update-document",
                type: "POST",
                data: JSON.stringify({ filename, content }),
                contentType: "application/json",
                success: function(response) {
                    console.log(response);
                    listDocuments();
                }
            });
        });

        // Delete document
        $("#delete-form").submit(function(e) {
            e.preventDefault();
            const filename = $("#filename").val();

            $.ajax({
                url: api_url + "/delete-document",
                type: "POST",
                data: JSON.stringify({ filename }),
                contentType: "application/json",
                success: function(response) {
                    console.log(response);
                    listDocuments();
                }
            });
        });

        // Generate document
        $("#generate-form").submit(function(e) {
            e.preventDefault();
            const prompt = $("#prompt").val();

            $.ajax({
                url: api_url + "/generate-document",
                type: "POST",
                data: JSON.stringify({ prompt }),
                contentType: "application/json",
                success: function(response) {
                    console.log(response);
                    listDocuments();
                }
            });
        });
    </script>
</body>
</html>
